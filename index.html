<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Terraria Web</title>
<style>
  body { margin: 0; background: #87ceeb; }
  canvas { display: block; margin: auto; background: #87ceeb; }
</style>
</head>
<body>

<canvas id="game" width="800" height="480"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const TILE = 32;
const WORLD_W = 50;
const WORLD_H = 15;

let world = [];
for (let x = 0; x < WORLD_W; x++) {
  world[x] = [];
  let ground = 7 + Math.floor(Math.random() * 3);
  for (let y = 0; y < WORLD_H; y++) {
    if (y > ground) world[x][y] = "dirt";
    else if (y === ground) world[x][y] = "grass";
    else world[x][y] = null;
  }
}

let player = { x: 100, y: 0, w: 24, h: 36, vy: 0, onGround: false };
let keys = {};

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

canvas.addEventListener("click", e => {
  let rect = canvas.getBoundingClientRect();
  let x = Math.floor((e.clientX - rect.left) / TILE);
  let y = Math.floor((e.clientY - rect.top) / TILE);
  if (world[x] && world[x][y]) world[x][y] = null;
});

function update() {
  if (keys["a"]) player.x -= 3;
  if (keys["d"]) player.x += 3;
  if (keys[" "] && player.onGround) {
    player.vy = -10;
    player.onGround = false;
  }

  player.vy += 0.5;
  player.y += player.vy;

  player.onGround = false;
  for (let x = 0; x < WORLD_W; x++) {
    for (let y = 0; y < WORLD_H; y++) {
      if (!world[x][y]) continue;
      let tx = x * TILE;
      let ty = y * TILE;
      if (player.x < tx + TILE &&
          player.x + player.w > tx &&
          player.y < ty + TILE &&
          player.y + player.h > ty) {
        if (player.vy > 0) {
          player.y = ty - player.h;
          player.vy = 0;
          player.onGround = true;
        }
      }
    }
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  for (let x = 0; x < WORLD_W; x++) {
    for (let y = 0; y < WORLD_H; y++) {
      if (!world[x][y]) continue;
      ctx.fillStyle = world[x][y] === "grass" ? "#228B22" : "#8B4513";
      ctx.fillRect(x*TILE, y*TILE, TILE, TILE);
    }
  }

  ctx.fillStyle = "#c83232";
  ctx.fillRect(player.x, player.y, player.w, player.h);
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
